<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/webpack-guidebook/umi.331878c1.css" />
    <script>
      window.routerBase = "/webpack-guidebook/";
    </script>
    <script>
      //! umi version: 3.5.20
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>Tapable - Webpack Guidebook</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/infra/implementation-principle/tapable" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/webpack-guidebook//">Webpack Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/webpack-guidebook//basic">åŸºæœ¬ç»¼è¿°</a></span><span><a aria-current="page" class="active" href="/webpack-guidebook//infra">æ¶æ„åŸç†</a></span><span><a href="/webpack-guidebook//best-practice">æœ€ä½³å®è·µ</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/webpack-guidebook//"></a><h1>Webpack Guidebook</h1><p>Webpack å®Œå…¨çŸ¥è¯†ä½“ç³»</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/webpack-guidebook//basic">åŸºæœ¬ç»¼è¿°</a></li><li><a aria-current="page" class="active" href="/webpack-guidebook//infra">æ¶æ„åŸç†</a></li><li><a href="/webpack-guidebook//best-practice">æœ€ä½³å®è·µ</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a target="_blank" rel="noopener noreferrer">å·¥ä½œåŸç†</a><ul><li><a href="/webpack-guidebook//infra/operational-principle/file-watch"><span>æ–‡ä»¶ç›‘å¬</span></a></li><li><a href="/webpack-guidebook//infra/operational-principle/hot-module-replacement"><span>æ¨¡å—çƒ­æ›´æ–°</span></a></li><li><a href="/webpack-guidebook//infra/operational-principle/filenames-hashes"><span>æ–‡ä»¶æŒ‡çº¹ç­–ç•¥</span></a></li><li><a href="/webpack-guidebook//infra/operational-principle/tree-shaking"><span>Tree Shaking</span></a></li><li><a href="/webpack-guidebook//infra/operational-principle/scope-hoisting"><span>ä½œç”¨åŸŸæå‡</span></a></li><li><a href="/webpack-guidebook//infra/operational-principle/sourcemap"><span>SourceMap</span></a></li></ul></li><li><a href="/webpack-guidebook//infra/babel/babel">Babel</a></li><li><a target="_blank" rel="noopener noreferrer">åº•å±‚åŸç†</a><ul><li><a href="/webpack-guidebook//infra/implementation-principle/workflow"><span>æ„å»ºæµç¨‹</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/simple-implementation"><span>ç®€æ˜“å®ç°</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/source-code-analysis"><span>æºç åˆ†æ</span></a></li><li><a aria-current="page" class="active" href="/webpack-guidebook//infra/implementation-principle/tapable"><span>Tapable</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/compiler"><span>Compiler</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/compilation"><span>Compilation</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/loader"><span>Loader æœºåˆ¶</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/plugin"><span>Plugin æœºåˆ¶</span></a></li><li><a href="/webpack-guidebook//infra/implementation-principle/ast"><span>æŠ½è±¡è¯­æ³•æ ‘</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="åŸºæœ¬æ¦‚å¿µ" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></li><li title="ä½¿ç”¨ç¤ºä¾‹" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></li><li title="å®ä¾‹é’©å­" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#å®ä¾‹é’©å­"><span>å®ä¾‹é’©å­</span></a></li><li title="é’©å­åˆ†ç±»" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#é’©å­åˆ†ç±»"><span>é’©å­åˆ†ç±»</span></a></li><li title="ä½¿ç”¨æ–¹å¼" data-depth="3"><a href="/webpack-guidebook//infra/implementation-principle/tapable#ä½¿ç”¨æ–¹å¼"><span>ä½¿ç”¨æ–¹å¼</span></a></li><li title="æ‹¦æˆªå™¨" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#æ‹¦æˆªå™¨"><span>æ‹¦æˆªå™¨</span></a></li><li title="ä¸Šä¸‹æ–‡" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#ä¸Šä¸‹æ–‡"><span>ä¸Šä¸‹æ–‡</span></a></li><li title="å‚è€ƒèµ„æ–™" data-depth="2"><a href="/webpack-guidebook//infra/implementation-principle/tapable#å‚è€ƒèµ„æ–™"><span>å‚è€ƒèµ„æ–™</span></a></li><li title="Tapable ç”¨æ³•" data-depth="3"><a href="/webpack-guidebook//infra/implementation-principle/tapable#tapable-ç”¨æ³•"><span>Tapable ç”¨æ³•</span></a></li><li title="å®ç°ç®€æ˜“åŒæ­¥é’©å­" data-depth="3"><a href="/webpack-guidebook//infra/implementation-principle/tapable#å®ç°ç®€æ˜“åŒæ­¥é’©å­"><span>å®ç°ç®€æ˜“åŒæ­¥é’©å­</span></a></li><li title="Tapable å¦‚ä½•ä¸æ’ä»¶å…³è”" data-depth="3"><a href="/webpack-guidebook//infra/implementation-principle/tapable#tapable-å¦‚ä½•ä¸æ’ä»¶å…³è”"><span>Tapable å¦‚ä½•ä¸æ’ä»¶å…³è”</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="tapable"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#tapable"><span class="icon icon-link"></span></a>Tapable</h1><p>Webpack æœ¬è´¨ä¸Šæ˜¯ä¸€ç§äº‹ä»¶æµçš„æœºåˆ¶ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å°±æ˜¯å°†å„ä¸ªæ’ä»¶ä¸²è”èµ·æ¥ï¼Œè€Œå®ç°è¿™ä¸€åˆ‡çš„æ ¸å¿ƒå°±æ˜¯ Tapableï¼ŒWebpack ä¸­æœ€æ ¸å¿ƒçš„è´Ÿè´£ç¼–è¯‘çš„ Compiler å’Œè´Ÿè´£åˆ›å»º bundles çš„ Compilation éƒ½æ˜¯ Tapable çš„å­ç±»ï¼Œå¹¶ä¸”å®ä¾‹å†…éƒ¨çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯é€šè¿‡ Tapable åº“æä¾›çš„é’©å­ç±»å®ç°çš„ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#åŸºæœ¬æ¦‚å¿µ"><span class="icon icon-link"></span></a>åŸºæœ¬æ¦‚å¿µ</h2><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/webpack/tapable">Tapable<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ˜¯ä¸€ä¸ªå°å‹çš„åº“ï¼Œå…è®¸ä½ å¯¹ä¸€ä¸ª JavaScript æ¨¡å—æ·»åŠ å’Œåº”ç”¨æ’ä»¶ã€‚å®ƒå¯ä»¥è¢«ç»§æ‰¿æˆ–æ··å…¥åˆ°å…¶ä»–æ¨¡å—ä¸­ã€‚</p><p>Tapable æ˜¯ç±»ä¼¼äº Node.js çš„ EventEmitter çš„ç±»ï¼Œä¸“æ³¨äºè‡ªå®šä¹‰äº‹ä»¶çš„è§¦å‘å’Œå¤„ç†ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒTapable è¿˜å…è®¸ä½ é€šè¿‡å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œè®¿é—®äº‹ä»¶çš„ <strong>è§¦å‘è€…</strong>ï¼ˆemitteeï¼‰æˆ– <strong>æä¾›è€…</strong>ï¼ˆproducerï¼‰ï¼Œä»è€Œæ§åˆ¶ç€ Webpack çš„æ’ä»¶ç³»ç»Ÿã€‚</p><p>Tapable æœ‰å››ç»„æˆå‘˜å‡½æ•°ï¼š</p><ul><li><code>plugin(name:string, handler:function)</code>ï¼šå…è®¸å°†ä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶æ³¨å†Œåˆ° Tapable å®ä¾‹ çš„äº‹ä»¶ä¸­ã€‚å®ƒçš„è¡Œä¸ºå’Œ EventEmitter çš„ <code>on()</code> æ–¹æ³•ç›¸ä¼¼ï¼Œç”¨æ¥æ³¨å†Œä¸€ä¸ªå¤„ç†å‡½æ•°/ç›‘å¬å™¨ï¼Œæ¥åœ¨ä¿¡å·/äº‹ä»¶å‘ç”Ÿæ—¶åšä¸€äº›äº‹æƒ…ã€‚</li><li><code>apply(â€¦pluginInstances: (AnyPlugin|function)[])</code>ï¼š<code>AnyPlugin</code> åº”è¯¥æ˜¯ä¸€ä¸ªæ‹¥æœ‰ <code>apply</code> æ–¹æ³•çš„ç±»ï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸å¸¸è§ï¼‰ï¼Œæˆ–è€…åªæ˜¯ä¸€ä¸ªåŒ…å«æ³¨å†Œä»£ç çš„å‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•åª <strong>è°ƒç”¨</strong> æ’ä»¶çš„å®šä¹‰ï¼Œä»è€Œå°†çœŸæ­£çš„äº‹ä»¶ç›‘å¬å™¨å¯ä»¥æ³¨å†Œåˆ° <em>Tapable</em> å®ä¾‹çš„æ³¨å†Œåˆ—è¡¨ä¸­ã€‚</li><li><code>applyPlugins*(name:string, â€¦)</code>ï¼š<em>Tapable</em> å®ä¾‹å¯ä»¥é€šè¿‡ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œåœ¨æŒ‡å®šçš„ <code>hash</code> ä¸‹åº”ç”¨æ‰€æœ‰çš„æ’ä»¶ã€‚è¿™ä¸€ç»„æ–¹æ³•çš„è¡Œä¸ºå’Œ <code>EventEmitter</code> çš„ <code>emit()</code> æ–¹æ³•ç›¸ä¼¼ï¼Œä½¿ç”¨å¤šç§ç­–ç•¥ç»†è‡´åœ°æ§åˆ¶äº‹ä»¶çš„è§¦å‘ã€‚</li><li><code>mixin(pt: Object)</code>ï¼šä¸€ä¸ªç®€å•åœ°æ–¹æ³•ï¼Œä½¿ç”¨æ··å…¥è€Œä¸æ˜¯ç»§æ‰¿çš„æ–¹å¼æ‰©å±• <code>Tapable</code> çš„åŸå‹ã€‚</li></ul><p>ä¸åŒçš„ <code>applyPlugins*</code> æ–¹æ³•è¦†ç›–äº†ä»¥ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>è¿ç»­åœ°æ‰§è¡Œæ’ä»¶ã€‚</li><li>å¹¶è¡Œåœ°æ‰§è¡Œæ’ä»¶ã€‚</li><li>ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œæ’ä»¶ï¼Œä»å‰é¢çš„æ’ä»¶ï¼ˆç€‘å¸ƒæµï¼‰è·å–è¾“å…¥ã€‚</li><li>å¼‚æ­¥åœ°æ‰§è¡Œæ’ä»¶ã€‚</li><li>åœ¨å…è®¸æ—¶åœæ­¢æ‰§è¡Œæ’ä»¶ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä¸€ä¸ªæ’ä»¶è¿”å›äº†ä¸€ä¸ªé <code>undefined</code> å€¼ï¼Œè·³å‡ºæ‰§è¡Œæµï¼Œè¿”å›è¿™ä¸ªæ’ä»¶çš„è¿”å›å€¼ã€‚å¬èµ·æ¥åƒæ˜¯ <code>EventEmitter</code> çš„ <code>once()</code> æ–¹æ³•ï¼Œä½†æ˜¯å®Œå…¨ä¸åŒã€‚</li></ul><h2 id="ä½¿ç”¨ç¤ºä¾‹"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#ä½¿ç”¨ç¤ºä¾‹"><span class="icon icon-link"></span></a>ä½¿ç”¨ç¤ºä¾‹</h2><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.docschina.org/api/compiler">Compiler<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ˜¯ Webpack çš„ä¸€ä¸ªæ ¸å¿ƒ Tapable å®ä¾‹ï¼Œè´Ÿè´£ç¼–è¯‘ Webpack é…ç½®å¯¹è±¡å¹¶è¿”å› <a target="_blank" rel="noopener noreferrer" href="https://webpack.docschina.org/api/compilation">Compilation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å®ä¾‹ã€‚è€Œ Compilation å®ä¾‹æ‰§è¡Œæ—¶ï¼Œä¼šåˆ›å»ºæ‰€éœ€çš„ bundlesã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// node_modules/webpacl/lib/Compiler.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> </span><span class="token maybe-class-name">Tapable</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;tapable&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function maybe-class-name">Compiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">Tapable</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token class-name">Compiler</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token class-name">Tapable</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>ç°åœ¨åœ¨è¿™ä¸ª compiler ä¸Šå†™æ’ä»¶ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// my-custom-plugin.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function maybe-class-name">CustomPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token class-name">CustomPlugin</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">apply</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  compiler</span><span class="token punctuation">.</span><span class="token method function property-access">plugin</span><span class="token punctuation">(</span><span class="token string">&#x27;emit&#x27;</span><span class="token punctuation">,</span><span class="token plain"> pluginFunction</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>compiler ä¼šåœ¨ç”Ÿå‘½å‘¨æœŸä¸­é€‚å½“çš„æ—¶æœºæ‰§è¡Œè¿™ä¸ªæ’ä»¶ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// node_modules/webpacl/lib/Compiler.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// å°†è·å– `emit` åç§°ä¸‹æ‰€æœ‰æ’ä»¶å¹¶è¿è¡Œå®ƒä»¬</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">apply</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;emit&#x27;</span><span class="token punctuation">,</span><span class="token plain"> options</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><h2 id="å®ä¾‹é’©å­"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#å®ä¾‹é’©å­"><span class="icon icon-link"></span></a>å®ä¾‹é’©å­</h2><p>Tapable åº“æš´éœ²äº†å¾ˆå¤š Hookï¼ˆé’©å­ï¼‰ç±»ï¼Œä¸ºæ’ä»¶æä¾›æŒ‚è½½çš„é’©å­ï¼š</p><table><thead><tr><th align="left">é’©å­</th><th align="left">é’©å…¥æ–¹å¼</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="left">Hook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">é’©å­åŸºç±»</td></tr><tr><td align="left">SyncHook</td><td align="left"><code>tap</code></td><td align="left">åŒæ­¥é’©å­</td></tr><tr><td align="left">SyncBailHook</td><td align="left"><code>tap</code></td><td align="left">åŒæ­¥ç†”æ–­é’©å­ï¼Œåªè¦æ‰§è¡Œçš„ handler æœ‰è¿”å›å€¼ï¼Œå‰©ä½™ handler ä¸æ‰§è¡Œ</td></tr><tr><td align="left">SyncWaterfallHook</td><td align="left"><code>tap</code></td><td align="left">åŒæ­¥æµæ°´é’©å­ï¼Œä¸Šä¸ª handler çš„è¿”å›å€¼ä½œä¸ºä¸‹ä¸ª handler çš„è¾“å…¥å€¼</td></tr><tr><td align="left">SyncLoopHook</td><td align="left"><code>tap</code></td><td align="left">åŒæ­¥å¾ªç¯é’©å­ï¼Œåªè¦æ‰§è¡Œçš„ handler æœ‰è¿”å›å€¼ï¼Œä¸€ç›´å¾ªç¯æ‰§è¡Œæ­¤ handler</td></tr><tr><td align="left">AsyncParallelHook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">å¼‚æ­¥å¹¶å‘é’©å­ï¼Œhandler å¹¶è¡Œè§¦å‘</td></tr><tr><td align="left">AsyncParallelBailHook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">å¼‚æ­¥å¹¶å‘ç†”æ–­é’©å­ï¼Œhandler å¹¶è¡Œè§¦å‘ï¼Œä½†æ˜¯è·Ÿ handler å†…éƒ¨è°ƒç”¨å›è°ƒå‡½æ•°çš„é€»è¾‘æœ‰å…³</td></tr><tr><td align="left">AsyncSeriesHook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">å¼‚æ­¥ä¸²è¡Œé’©å­ï¼Œhandler ä¸²è¡Œè§¦å‘</td></tr><tr><td align="left">AsyncSeriesBailHook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">å¼‚æ­¥ä¸²è¡Œç†”æ–­é’©å­ï¼Œhandler å¹¶è¡Œè§¦å‘ï¼Œä½†æ˜¯è·Ÿ handler å†…éƒ¨è°ƒç”¨å›è°ƒå‡½æ•°çš„é€»è¾‘æœ‰å…³</td></tr><tr><td align="left">AsyncSeriesWaterfallHook</td><td align="left"><code>tap</code>ã€<code>tapAsync</code>ã€<code>tapPromise</code></td><td align="left">å¼‚æ­¥ä¸²è¡Œæµæ°´é’©å­ï¼Œä¸Šä¸ª handler å¯ä»¥æ ¹æ®å†…éƒ¨çš„å›è°ƒå‡½æ•°ä¼ ç»™ä¸‹ä¸ª handler</td></tr></tbody></table><p><strong>Hook Helper ä¸ Tapable ç±»</strong></p><table><thead><tr><th align="left">åç§°</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="left">HookCodeFactory</td><td align="left">ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œ fn çš„å·¥å‚ç±»</td></tr><tr><td align="left">HookMap</td><td align="left">Map ç»“æ„ï¼Œå­˜å‚¨å¤šä¸ª Hook å®ä¾‹</td></tr><tr><td align="left">MutiHook</td><td align="left">ç»„åˆå¤šä¸ª Hook å®ä¾‹</td></tr><tr><td align="left">Tapable</td><td align="left">å‘å‰å…¼å®¹è€ç‰ˆæœ¬ï¼Œå®ä¾‹å¿…é¡»æ‹¥æœ‰ Hooks å±æ€§</td></tr></tbody></table><h2 id="é’©å­åˆ†ç±»"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#é’©å­åˆ†ç±»"><span class="icon icon-link"></span></a>é’©å­åˆ†ç±»</h2><p>Hook çš„ç±»å‹å¯ä»¥æŒ‰ç…§ <strong>äº‹ä»¶å›è°ƒçš„è¿è¡Œé€»è¾‘</strong> æˆ–è€… <strong>è§¦å‘äº‹ä»¶çš„æ–¹å¼</strong> æ¥åˆ†ç±»ã€‚</p><p><strong>äº‹ä»¶å›è°ƒçš„è¿è¡Œé€»è¾‘</strong></p><table><thead><tr><th align="left">ç±»å‹</th><th align="left">æ–¹æ³•</th></tr></thead><tbody><tr><td align="left">Basic</td><td align="left">åŸºç¡€ç±»å‹ï¼Œå•çº¯çš„è°ƒç”¨æ³¨å†Œçš„äº‹ä»¶å›è°ƒï¼Œå¹¶å¹¶ä¸å…³å¿ƒå…¶å†…éƒ¨çš„è¿è¡Œé€»è¾‘</td></tr><tr><td align="left">Bail</td><td align="left">ä¿é™©ç±»å‹ï¼Œå½“ä¸€ä¸ªäº‹ä»¶å›è°ƒåœ¨è¿è¡Œæ—¶è¿”å›çš„å€¼ä¸ä¸º <code>undefined</code> æ—¶ï¼Œåœæ­¢åé¢äº‹ä»¶å›è°ƒçš„æ‰§è¡Œ</td></tr><tr><td align="left">Waterfall</td><td align="left">ç€‘å¸ƒç±»å‹ï¼Œå¦‚æœå½“å‰æ‰§è¡Œçš„äº‹ä»¶å›è°ƒè¿”å›å€¼ä¸ä¸º <code>undefined</code>ï¼Œé‚£ä¹ˆå°±æŠŠä¸‹ä¸€ä¸ªäº‹ä»¶å›è°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ›¿æ¢æˆè¿™ä¸ªå€¼</td></tr><tr><td align="left">Loop</td><td align="left">å¾ªç¯ç±»å‹ï¼Œå¦‚æœå½“å‰æ‰§è¡Œçš„äº‹ä»¶å›è°ƒçš„è¿”å›å€¼ä¸æ˜¯ <code>undefined</code>ï¼Œé‡æ–°ä»ç¬¬ä¸€ä¸ªæ³¨å†Œçš„äº‹ä»¶å›è°ƒå¤„æ‰§è¡Œï¼Œç›´åˆ°å½“å‰æ‰§è¡Œçš„äº‹ä»¶å›è°ƒæ²¡æœ‰è¿”å›å€¼</td></tr></tbody></table><p><strong>è§¦å‘äº‹ä»¶çš„æ–¹å¼</strong></p><table><thead><tr><th align="left">ç±»å‹</th><th align="left">æ–¹æ³•</th></tr></thead><tbody><tr><td align="left">Sync</td><td align="left">åŒæ­¥æ–¹æ³•ã€‚Sync å¼€å¤´çš„ Hook ç±»åªèƒ½ç”¨ <code>tap</code> æ–¹æ³•æ³¨å†Œäº‹ä»¶å›è°ƒï¼Œè¿™ç±»äº‹ä»¶å›è°ƒä¼šåŒæ­¥æ‰§è¡Œï¼›å¦‚æœä½¿ç”¨ <code>tapAsync</code> æˆ–è€… <code>tapPromise</code> æ–¹æ³•æ³¨å†Œåˆ™ä¼š<strong style="color:red">æŠ¥é”™</strong></td></tr><tr><td align="left">AsyncSeries</td><td align="left">å¼‚æ­¥ä¸²è¡Œé’©å­ã€‚Async å¼€å¤´çš„ Hook ç±»ï¼Œæ²¡æ³•ç”¨ <code>call</code> æ–¹æ³•è§¦å‘äº‹ä»¶ï¼Œå¿…é¡»ç”¨ <code>callAsync</code> æˆ–è€… Promise æ–¹æ³•è§¦å‘ï¼›è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½èƒ½è§¦å‘ <code>tap</code>ã€<code>tapAsync</code> å’Œ <code>tapPromise</code> æ³¨å†Œçš„äº‹ä»¶å›è°ƒï¼›AsyncSeries æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œå½“å‰äº‹ä»¶å›è°ƒå¦‚æœæ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆä¼šç­‰åˆ°å¼‚æ­¥æ‰§è¡Œå®Œæ¯•æ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªäº‹ä»¶å›è°ƒã€‚</td></tr><tr><td align="left">AsyncParallel</td><td align="left">å¼‚æ­¥å¹¶è¡Œæ‰§è¡Œé’©å­ã€‚AsyncParalle ä¼šå¹¶è¡Œæ‰§è¡Œæ‰€æœ‰çš„äº‹ä»¶å›è°ƒ</td></tr></tbody></table><h3 id="ä½¿ç”¨æ–¹å¼"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#ä½¿ç”¨æ–¹å¼"><span class="icon icon-link"></span></a>ä½¿ç”¨æ–¹å¼</h3><p>Tapable æš´éœ²å‡ºæ¥çš„éƒ½æ˜¯ç±»æ–¹æ³•ï¼Œ<code>new</code> ä¸€ä¸ªç±»æ–¹æ³•è·å¾—æˆ‘ä»¬éœ€è¦çš„é’©å­ã€‚</p><p>class æ¥å—æ•°ç»„å‚æ•° <code>options</code>ï¼Œéå¿…ä¼ ã€‚ç±»æ–¹æ³•ä¼šæ ¹æ®ä¼ å‚ï¼Œæ¥å—åŒæ ·æ•°é‡çš„å‚æ•°ã€‚</p><p>ğŸŒ° <strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> hook1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;arg1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;arg2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;arg3&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>Tabpack æä¾›äº† åŒæ­¥ &amp; å¼‚æ­¥ ç»‘å®šé’©å­çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä»–ä»¬éƒ½æœ‰å¸® ID éš¾è¿‡äº‹ä»¶å’Œæ‰§è¡Œäº‹ä»¶å¯¹åº”çš„æ–¹æ³•ã€‚</p><table><thead><tr><th align="left">Async*</th><th align="left">Sync*</th></tr></thead><tbody><tr><td align="left">ç»‘å®šï¼š<code>tapAsync/tapPromise/tap</code></td><td align="left">ç»‘å®šï¼š<code>tap</code></td></tr><tr><td align="left">æ‰§è¡Œï¼š<code>callAsync/promise</code></td><td align="left">æ‰§è¡Œï¼š<code>call</code></td></tr></tbody></table><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> hook1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;arg1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;arg2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;arg3&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// ç»‘å®šäº‹ä»¶åˆ° Webpack äº‹ä»¶æµ</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">hook1</span><span class="token punctuation">.</span><span class="token method function property-access">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;hook1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">arg1</span><span class="token parameter punctuation">,</span><span class="token parameter"> arg2</span><span class="token parameter punctuation">,</span><span class="token parameter"> arg3</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">arg1</span><span class="token punctuation">,</span><span class="token plain"> arg2</span><span class="token punctuation">,</span><span class="token plain"> arg3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// æ‰§è¡Œç»‘å®šçš„äº‹ä»¶</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">hook1</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><h2 id="æ‹¦æˆªå™¨"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#æ‹¦æˆªå™¨"><span class="icon icon-link"></span></a>æ‹¦æˆªå™¨</h2><p>æ‰€æœ‰é’©å­éƒ½æä¾›é¢å¤–çš„æ‹¦æˆªå™¨ï¼ˆInterceptionï¼‰ APIï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// æ³¨å†Œæ‹¦æˆªå™¨</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">calculateRoutes</span><span class="token punctuation">.</span><span class="token method function property-access">intercept</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">call</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token parameter punctuation">,</span><span class="token parameter"> target</span><span class="token parameter punctuation">,</span><span class="token parameter"> routesList</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Starting to calculate routes.&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">register</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">tapInfo</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// tapInfo = { type: &#x27;promise&#x27;, name: &#x27;GoogleMapsPlugin&#x27;, fn: ... }</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">tapInfo</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> is doing sth.</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">return</span><span class="token plain"> tapInfo</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><ul><li><code>call: (...args) =&gt; void</code>ï¼šå½“ä½ çš„é’©å­è§¦å‘ä¹‹å‰ï¼ˆä¹Ÿå°±æ˜¯ <code>call()</code> ä¹‹å‰ï¼‰ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥è®¿é—®é’©å­çš„å‚æ•°ï¼Œå¤šä¸ªé’©å­æ‰§è¡Œä¸€æ¬¡</li><li><code>tap: (tap:Tap) =&gt; void</code>ï¼šæ¯ä¸ªé’©å­æ‰§è¡Œä¹‹å‰ï¼ˆå¤šä¸ªé’©å­æ‰§è¡Œå¤šä¸ªï¼‰ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªå‡½æ•°</li><li><code>loop: (...args) =&gt; void</code>ï¼šè¿™ä¸ªä¼šä¸ºä½ çš„æ¯ä¸ªå¾ªç¯é’©å­ï¼ˆLoopHookï¼Œå°±æ˜¯ç±»å‹åˆ° Loop çš„ï¼‰è§¦å‘ï¼Œå…·ä½“ä»€ä¹ˆæ—¶å€™æ²¡è¯´</li><li><code>register: (tap: Tap) =&gt; Tap | undefined</code>ï¼šæ¯æ·»åŠ ä¸€ä¸ª Tap éƒ½ä¼šè§¦å‘ä½  interceptor ä¸Šçš„ registerï¼Œä½ ä¸‹ä¸ªæ‹¦æˆªå™¨çš„ register å‡½æ•°å¾—åˆ°çš„å‚æ•°ï¼Œå–å†³äºä½ ä¸Šä¸ª register è¿”å›çš„å€¼ï¼Œæ‰€ä»¥æœ€å¥½è¿”å›ä¸€ä¸ª <code>tap</code> é’©å­</li></ul><h2 id="ä¸Šä¸‹æ–‡"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#ä¸Šä¸‹æ–‡"><span class="icon icon-link"></span></a>ä¸Šä¸‹æ–‡</h2><p>æ’ä»¶å’Œæ‹¦æˆªå™¨éƒ½å¯ä»¥é€‰æ‹©åŠ å…¥ä¸€ä¸ªå¯é€‰çš„ <code>context</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯ä»¥è¢«ç”¨äºä¼ é€’éšæ„çš„å€¼åˆ°é˜Ÿåˆ—ä¸­çš„æ’ä»¶å’Œæ‹¦æˆªå™¨ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">accelerate</span><span class="token punctuation">.</span><span class="token method function property-access">intercept</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  context</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">tap</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token parameter punctuation">,</span><span class="token parameter"> tapInfo</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// tapInfo = { type: &quot;sync&quot;, name: &quot;NoisePlugin&quot;, fn: ... }</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">tapInfo</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> is doing it&#x27;s job</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// `context` starts as an empty object if at least one plugin uses `context: true`.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// å¦‚æœæœ€å°‘æœ‰ä¸€ä¸ªæ’ä»¶ä½¿ç”¨ `context` é‚£ä¹ˆcontext ä¸€å¼€å§‹æ˜¯ä¸€ä¸ªç©ºçš„å¯¹è±¡</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// If no plugins use `context: true`, then `context` is undefined</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// å¦‚è¿‡tapè¿›å»çš„æ’ä»¶æ²¡æœ‰ä½¿ç”¨`context` çš„ é‚£ä¹ˆå†…éƒ¨çš„`context` ä¸€å¼€å§‹å°±æ˜¯undefined</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">context</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// Arbitrary properties can be added to `context`, which plugins can then access.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// ä»»æ„å±æ€§éƒ½å¯ä»¥æ·»åŠ åˆ°`context`, æ’ä»¶å¯ä»¥è®¿é—®åˆ°è¿™äº›å±æ€§</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      context</span><span class="token punctuation">.</span><span class="token property-access">hasMuffler</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">accelerate</span><span class="token punctuation">.</span><span class="token method function property-access">tap</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;NoisePlugin&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    context</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token parameter punctuation">,</span><span class="token parameter"> newSpeed</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">context </span><span class="token operator">&amp;&amp;</span><span class="token plain"> context</span><span class="token punctuation">.</span><span class="token property-access">hasMuffler</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Silence...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword control-flow">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Vroom!&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><h2 id="å‚è€ƒèµ„æ–™"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#å‚è€ƒèµ„æ–™"><span class="icon icon-link"></span></a>å‚è€ƒèµ„æ–™</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/webpack/tapable">ğŸ“– webpack/tapable<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://webpack.docschina.org/api/tapable/#src/components/Sidebar/Sidebar.jsx">ğŸ“– Webpack ä¸­æ–‡æ–‡æ¡£ï¼šTapable<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/135997214">ğŸ“ Webpack æºç è§£è¯»ï¼šç†è§£ Tapable åŸç†ï¼ˆ2020-04-24ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/100974318">ğŸ“ Webpack æ ¸å¿ƒåº“ Tapable çš„ä½¿ç”¨ä¸åŸç†åˆ†æï¼ˆ2020-01-06ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.im/post/5dc169b0f265da4d542092c6">ğŸ“Webpack æ’ä»¶æœºåˆ¶ä¹‹ Tapable æºç è§£æï¼ˆ2019-11-25ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.im/post/5dcba29f6fb9a04abb01fd77">ğŸ“ ç¼–å†™è‡ªå®šä¹‰ Webpack æ’ä»¶ä»ç†è§£ Tapable å¼€å§‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.im/post/5dc16519f265da4cf1583eb2">ğŸ“ æ·±å…¥æºç è§£æ Tapable å®ç°åŸç†ï¼ˆ2019-11-05ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/89443337">ğŸ“ åŸºäºæ•°æ®ç»“æ„ä»æºç è§£æ Webpack æ ¸å¿ƒæ¨¡å— Tapableï¼ˆ2019-10-31ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.im/post/5d36faa9e51d45109725ff55">ğŸ“ Webpack Tapable ä½¿ç”¨ç ”ç©¶<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.im/post/5beb8875e51d455e5c4dd83f">ğŸ“ å¹²è´§ï¼æ’¸ä¸€ä¸ª Webpack æ’ä»¶ï¼ˆå†…å« Tapable è¯¦è§£+ Webpack æµç¨‹ï¼‰ï¼ˆ2018-11-14ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/33577267">ğŸ“ å¼‚æ­¥ç¼–ç¨‹å­¦ä¹ ç¬”è®°ä¹‹ Tapable æºç åˆ†æï¼ˆ2018-02-05ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h3 id="tapable-ç”¨æ³•"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#tapable-ç”¨æ³•"><span class="icon icon-link"></span></a>Tapable ç”¨æ³•</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">SyncHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">SyncBailHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">SyncWaterfallHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">SynLoopHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">AsyncParallelHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">AsyncParallelBailHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">AsyncSeriesHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">ASyncSeriesBailHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token maybe-class-name">AsyncSeriesWaterfallHook</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;tapable&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><ul><li><code>Sync*</code> åŒæ­¥<ul><li><code>SyncHook</code> åŒæ­¥é’©å­</li><li><code>SyncBailHook</code> åŒæ­¥ä¿é™©é’©å­</li><li><code>SyncLoopHook</code> åŒæ­¥å¾ªç¯é’©å­</li><li><code>SyncWaterfallHook</code> åŒæ­¥ç€‘å¸ƒé’©å­</li></ul></li><li><code>Async*</code> å¼‚æ­¥<ul><li><code>AsyncParallel*</code> å¼‚æ­¥å¹¶è¡Œ<ul><li><code>AsyncParallelHook</code> å¼‚æ­¥</li><li><code>AsyncParallelBailHook</code> å¼‚æ­¥å¹¶è¡Œä¿é™©é’©å­</li></ul></li><li><code>AsyncSeries*</code> å¼‚æ­¥ä¸²è¡Œ<ul><li><code>AsyncSeriesHook</code> å¼‚æ­¥ä¸²è¡Œé’©å­</li><li><code>AsyncSeriesBailHook</code> å¼‚æ­¥ä¸²è¡Œä¿é™©é’©å­</li><li><code>AsyncSeriesWaterfallHook</code> å¼‚æ­¥ä¸²è¡Œç€‘å¸ƒé’©å­</li></ul></li></ul></li></ul><h3 id="å®ç°ç®€æ˜“åŒæ­¥é’©å­"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#å®ç°ç®€æ˜“åŒæ­¥é’©å­"><span class="icon icon-link"></span></a>å®ç°ç®€æ˜“åŒæ­¥é’©å­</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">Hook</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">taps</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">interceptors</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// è¿™ä¸ªæ”¾åœ¨åé¢ç”¨</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_args</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> args</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token parameter punctuation">,</span><span class="token parameter"> fn</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">taps</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">,</span><span class="token plain"> fn </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">SyncHook</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">Hook</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">call</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token parameter punctuation">,</span><span class="token parameter"> fn</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">try</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">taps</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">tap</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> tap</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"> name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword control-flow">catch</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><h3 id="tapable-å¦‚ä½•ä¸æ’ä»¶å…³è”"><a aria-hidden="true" tabindex="-1" href="/webpack-guidebook//infra/implementation-principle/tapable#tapable-å¦‚ä½•ä¸æ’ä»¶å…³è”"><span class="icon icon-link"></span></a>Tapable å¦‚ä½•ä¸æ’ä»¶å…³è”</h3><p><strong>Compile.js</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">AsyncSeriesHook</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">SyncHook</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;tapable&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// åˆ›å»ºç±»</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">Compiler</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// å¼‚æ­¥é’©å­</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      run</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">AsyncSeriesHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;compiler&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// åŒæ­¥é’©å­</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      compile</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;params&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// æ‰§è¡Œå¼‚æ­¥é’©å­</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">run</span><span class="token punctuation">.</span><span class="token method function property-access">callAsync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">compile</span><span class="token punctuation">(</span><span class="token plain">onCompiled</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// æ‰§è¡ŒåŒæ­¥é’©å­ å¹¶ä¼ å‚</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token method function property-access">compile</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span><span class="token plain">params</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Compile</span><span class="token punctuation">;</span></div></pre></div><p><strong>MyPlugin.js</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">Compiler</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./compiler&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">MyPlugin</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// æ¥å— compiler å‚æ•°</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    compiler</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">run</span><span class="token punctuation">.</span><span class="token method function property-access">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;å¼€å§‹ç¼–è¯‘...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    compiler</span><span class="token punctuation">.</span><span class="token property-access">hooks</span><span class="token punctuation">.</span><span class="token property-access">compiler</span><span class="token punctuation">.</span><span class="token method function property-access">tapAsync</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token parameter punctuation">,</span><span class="token parameter"> age</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;ç¼–è¯‘ä¸­&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// è¿™é‡Œç±»ä¼¼äº webpack.config.js çš„ Plugins é…ç½®</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// å‘ Plugins å±æ€§ä¼ å…¥ new å®ä¾‹</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> myPlugin </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> options </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">myPlugin</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">let</span><span class="token plain"> compiler </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Compiler</span><span class="token punctuation">(</span><span class="token plain">options</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token method function property-access">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/Webpack-Guidebook/edit/master/docs/infra/implementation-principle/tapable.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">10/27/2021 19:01:12</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/webpack-guidebook/umi.ae1f7b6a.js"></script>
  </body>
</html>
